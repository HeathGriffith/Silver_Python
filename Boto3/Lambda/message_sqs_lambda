import boto3
import datetime
import os  # Import the os module to access environment variables

# Define the AWS SDK client
sqs = boto3.client('sqs')

def lambda_handler(event, context):
    # Retrieve the SQS queue URL from an environment variable
    queue_url = os.getenv('queue_url')
    
    if not queue_url:  # Check if the queue_url is None or an empty string
        raise ValueError("Missing queue URL. Set the queue_url environment variable.")
    
    # Create a message body, in this case, the current date and time
    message_body = str(datetime.datetime.now())
    
    try:
        # Send a message to the specified SQS queue
        response = sqs.send_message(QueueUrl=queue_url, MessageBody=message_body)
    except Exception as e:
        # Log the exception if there's an error
        print(f"Exception: {e}")
        raise e  # Re-raise the exception to AWS Lambda's error handling
    
    # Return a success response
    return {
        'statusCode': 200,
        'body': response
    }
